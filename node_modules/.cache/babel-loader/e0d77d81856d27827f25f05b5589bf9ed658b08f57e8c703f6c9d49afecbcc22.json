{"ast":null,"code":"export default {\n  name: 'ChatRoom',\n  data() {\n    return {\n      activeIndex: '4',\n      contacts: [{\n        id: 1,\n        name: '科技有限公司',\n        avatar: 'https://picsum.photos/200/200?random=1',\n        lastMessage: '您好，我们对您的简历很感兴趣',\n        time: '10:30',\n        unreadCount: 2\n      }, {\n        id: 2,\n        name: '互联网有限公司',\n        avatar: 'https://picsum.photos/200/200?random=2',\n        lastMessage: '请问您什么时候可以面试？',\n        time: '昨天',\n        unreadCount: 0\n      }, {\n        id: 3,\n        name: '软件有限公司',\n        avatar: 'https://picsum.photos/200/200?random=3',\n        lastMessage: '我们的薪资范围是15k-25k',\n        time: '上周',\n        unreadCount: 1\n      }],\n      selectedContactId: null,\n      messages: [],\n      inputMessage: ''\n    };\n  },\n  computed: {\n    isLoggedIn() {\n      return this.$store.getters.isLoggedIn || true; // 模拟登录状态\n    },\n    currentUser() {\n      return this.$store.getters.currentUser || {\n        username: '求职者',\n        role: 1\n      }; // 模拟用户数据\n    },\n    selectedContact() {\n      return this.contacts.find(contact => contact.id === this.selectedContactId) || {};\n    }\n  },\n  methods: {\n    handleSelect(key) {\n      switch (key) {\n        case '1':\n          this.$router.push('/');\n          break;\n        case '2':\n          this.$router.push('/jobs');\n          break;\n        case '3':\n          this.$router.push('/companies');\n          break;\n        case '4':\n          this.$router.push('/chat');\n          break;\n        case '5':\n          this.$router.push('/forum');\n          break;\n        case '6':\n          this.$router.push('/login');\n          break;\n        case '7':\n          this.$router.push('/register');\n          break;\n        case '8-1':\n          this.$router.push('/user');\n          break;\n        case '8-2':\n          this.$router.push('/admin');\n          break;\n      }\n    },\n    logout() {\n      this.$store.dispatch('logout');\n      this.$message.success('退出登录成功');\n      this.$router.push('/');\n    },\n    selectContact(id) {\n      this.selectedContactId = id;\n      // 模拟加载聊天记录\n      this.loadMessages(id);\n      // 清空未读消息\n      const contact = this.contacts.find(c => c.id === id);\n      if (contact) {\n        contact.unreadCount = 0;\n      }\n    },\n    loadMessages(contactId) {\n      // 模拟不同联系人的聊天记录\n      if (contactId === 1) {\n        this.messages = [{\n          id: 1,\n          content: '您好，我们看到了您的简历，对您很感兴趣',\n          isSent: false,\n          time: '09:30'\n        }, {\n          id: 2,\n          content: '请问您现在还在找工作吗？',\n          isSent: false,\n          time: '09:31'\n        }, {\n          id: 3,\n          content: '是的，我正在找前端开发的工作',\n          isSent: true,\n          time: '10:25'\n        }, {\n          id: 4,\n          content: '您好，我们对您的简历很感兴趣',\n          isSent: false,\n          time: '10:30'\n        }];\n      } else if (contactId === 2) {\n        this.messages = [{\n          id: 1,\n          content: '您好，我是互联网有限公司的HR',\n          isSent: false,\n          time: '昨天 14:20'\n        }, {\n          id: 2,\n          content: '请问您什么时候可以面试？',\n          isSent: false,\n          time: '昨天 14:21'\n        }, {\n          id: 3,\n          content: '我这周五有空',\n          isSent: true,\n          time: '昨天 15:00'\n        }];\n      } else if (contactId === 3) {\n        this.messages = [{\n          id: 1,\n          content: '您好，我们是软件有限公司',\n          isSent: false,\n          time: '上周 10:00'\n        }, {\n          id: 2,\n          content: '我们的薪资范围是15k-25k，请问您能接受吗？',\n          isSent: false,\n          time: '上周 10:01'\n        }];\n      }\n    },\n    sendMessage() {\n      if (!this.inputMessage.trim()) return;\n      const newMessage = {\n        id: this.messages.length + 1,\n        content: this.inputMessage,\n        isSent: true,\n        time: new Date().toLocaleTimeString([], {\n          hour: '2-digit',\n          minute: '2-digit'\n        })\n      };\n      this.messages.push(newMessage);\n      this.inputMessage = '';\n\n      // 发送消息到后端\n      this.$axios.post(`/messages/send/${this.selectedContactId}`, {\n        content: newMessage.content\n      }).then(response => {\n        // 处理成功响应\n        const replyMessage = response.data;\n        this.messages.push(replyMessage);\n      }).catch(error => {\n        console.error('发送消息失败:', error);\n        this.$message.error('发送消息失败，请稍后重试');\n        // 移除刚才添加的消息\n        this.messages.pop();\n        this.inputMessage = newMessage.content;\n      });\n    }\n  }\n};","map":{"version":3,"names":["name","data","activeIndex","contacts","id","avatar","lastMessage","time","unreadCount","selectedContactId","messages","inputMessage","computed","isLoggedIn","$store","getters","currentUser","username","role","selectedContact","find","contact","methods","handleSelect","key","$router","push","logout","dispatch","$message","success","selectContact","loadMessages","c","contactId","content","isSent","sendMessage","trim","newMessage","length","Date","toLocaleTimeString","hour","minute","$axios","post","then","response","replyMessage","catch","error","console","pop"],"sources":["src/views/ChatRoom.vue"],"sourcesContent":["<template>\n  <div class=\"chat-room-container\">\n    <!-- 导航栏 -->\n    <el-menu :default-active=\"activeIndex\" class=\"el-menu-demo\" mode=\"horizontal\" @select=\"handleSelect\">\n      <el-menu-item index=\"1\">首页</el-menu-item>\n      <el-menu-item index=\"2\">职位</el-menu-item>\n      <el-menu-item index=\"3\">企业</el-menu-item>\n      <el-menu-item index=\"4\">消息</el-menu-item>\n      <el-menu-item index=\"5\" v-if=\"isLoggedIn && currentUser.role === 0\">论坛</el-menu-item>\n      <el-menu-item index=\"6\" v-if=\"!isLoggedIn\">登录</el-menu-item>\n      <el-menu-item index=\"7\" v-if=\"!isLoggedIn\">注册</el-menu-item>\n      <el-submenu index=\"8\" v-if=\"isLoggedIn\">\n        <template slot=\"title\">{{ currentUser.username }}</template>\n        <el-menu-item index=\"8-1\">个人中心</el-menu-item>\n        <el-menu-item index=\"8-2\" v-if=\"currentUser.role === 2\">管理员面板</el-menu-item>\n        <el-menu-item index=\"8-3\" @click=\"logout\">退出登录</el-menu-item>\n      </el-submenu>\n    </el-menu>\n\n    <div class=\"chat-container\">\n      <!-- 左侧消息列表 -->\n      <div class=\"message-list\">\n        <div class=\"search-bar\">\n          <el-input placeholder=\"搜索聊天\" prefix-icon=\"el-icon-search\"></el-input>\n        </div>\n        <div class=\"contact-list\">\n          <div\n            v-for=\"contact in contacts\"\n            :key=\"contact.id\"\n            :class=\"{ 'active': selectedContactId === contact.id }\"\n            class=\"contact-item\"\n            @click=\"selectContact(contact.id)\"\n          >\n            <img :src=\"contact.avatar\" alt=\"头像\" class=\"avatar\">\n            <div class=\"contact-info\">\n              <div class=\"contact-name\">{{ contact.name }}</div>\n              <div class=\"last-message\">{{ contact.lastMessage }}</div>\n            </div>\n            <div class=\"message-time\">{{ contact.time }}</div>\n            <div v-if=\"contact.unreadCount > 0\" class=\"unread-count\">{{ contact.unreadCount }}</div>\n          </div>\n        </div>\n      </div>\n\n      <!-- 右侧聊天内容 -->\n      <div class=\"chat-content\" v-if=\"selectedContactId\">\n        <div class=\"chat-header\">\n          <img :src=\"selectedContact.avatar\" alt=\"头像\" class=\"avatar\">\n          <div class=\"contact-name\">{{ selectedContact.name }}</div>\n        </div>\n        <div class=\"messages-container\">\n          <div v-for=\"message in messages\" :key=\"message.id\" class=\"message-wrapper\">\n            <div :class=\"{ 'sent': message.isSent, 'received': !message.isSent }\" class=\"message-bubble\">\n              {{ message.content }}\n            </div>\n            <div :class=\"{ 'sent-time': message.isSent, 'received-time': !message.isSent }\" class=\"message-time\">\n              {{ message.time }}\n            </div>\n          </div>\n        </div>\n        <div class=\"message-input\">\n          <el-input\n            v-model=\"inputMessage\"\n            type=\"textarea\"\n            placeholder=\"请输入消息...\"\n            :rows=\"4\"\n            @keyup.enter.native=\"sendMessage\"\n          ></el-input>\n          <div class=\"send-button\">\n            <el-button type=\"primary\" @click=\"sendMessage\">发送</el-button>\n          </div>\n        </div>\n      </div>\n      <div class=\"no-selection\" v-else>\n        请选择一个聊天\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'ChatRoom',\n  data() {\n    return {\n      activeIndex: '4',\n      contacts: [\n        {\n          id: 1,\n          name: '科技有限公司',\n          avatar: 'https://picsum.photos/200/200?random=1',\n          lastMessage: '您好，我们对您的简历很感兴趣',\n          time: '10:30',\n          unreadCount: 2\n        },\n        {\n          id: 2,\n          name: '互联网有限公司',\n          avatar: 'https://picsum.photos/200/200?random=2',\n          lastMessage: '请问您什么时候可以面试？',\n          time: '昨天',\n          unreadCount: 0\n        },\n        {\n          id: 3,\n          name: '软件有限公司',\n          avatar: 'https://picsum.photos/200/200?random=3',\n          lastMessage: '我们的薪资范围是15k-25k',\n          time: '上周',\n          unreadCount: 1\n        }\n      ],\n      selectedContactId: null,\n      messages: [],\n      inputMessage: ''\n    };\n  },\n  computed: {\n    isLoggedIn() {\n      return this.$store.getters.isLoggedIn || true; // 模拟登录状态\n    },\n    currentUser() {\n      return this.$store.getters.currentUser || { username: '求职者', role: 1 }; // 模拟用户数据\n    },\n    selectedContact() {\n      return this.contacts.find(contact => contact.id === this.selectedContactId) || {};\n    }\n  },\n  methods: {\n    handleSelect(key) {\n      switch(key) {\n        case '1':\n          this.$router.push('/');\n          break;\n        case '2':\n          this.$router.push('/jobs');\n          break;\n        case '3':\n          this.$router.push('/companies');\n          break;\n        case '4':\n          this.$router.push('/chat');\n          break;\n        case '5':\n          this.$router.push('/forum');\n          break;\n        case '6':\n          this.$router.push('/login');\n          break;\n        case '7':\n          this.$router.push('/register');\n          break;\n        case '8-1':\n          this.$router.push('/user');\n          break;\n        case '8-2':\n          this.$router.push('/admin');\n          break;\n      }\n    },\n    logout() {\n      this.$store.dispatch('logout');\n      this.$message.success('退出登录成功');\n      this.$router.push('/');\n    },\n    selectContact(id) {\n      this.selectedContactId = id;\n      // 模拟加载聊天记录\n      this.loadMessages(id);\n      // 清空未读消息\n      const contact = this.contacts.find(c => c.id === id);\n      if (contact) {\n        contact.unreadCount = 0;\n      }\n    },\n    loadMessages(contactId) {\n      // 模拟不同联系人的聊天记录\n      if (contactId === 1) {\n        this.messages = [\n          { id: 1, content: '您好，我们看到了您的简历，对您很感兴趣', isSent: false, time: '09:30' },\n          { id: 2, content: '请问您现在还在找工作吗？', isSent: false, time: '09:31' },\n          { id: 3, content: '是的，我正在找前端开发的工作', isSent: true, time: '10:25' },\n          { id: 4, content: '您好，我们对您的简历很感兴趣', isSent: false, time: '10:30' }\n        ];\n      } else if (contactId === 2) {\n        this.messages = [\n          { id: 1, content: '您好，我是互联网有限公司的HR', isSent: false, time: '昨天 14:20' },\n          { id: 2, content: '请问您什么时候可以面试？', isSent: false, time: '昨天 14:21' },\n          { id: 3, content: '我这周五有空', isSent: true, time: '昨天 15:00' }\n        ];\n      } else if (contactId === 3) {\n        this.messages = [\n          { id: 1, content: '您好，我们是软件有限公司', isSent: false, time: '上周 10:00' },\n          { id: 2, content: '我们的薪资范围是15k-25k，请问您能接受吗？', isSent: false, time: '上周 10:01' }\n        ];\n      }\n    },\n    sendMessage() {\n      if (!this.inputMessage.trim()) return;\n      const newMessage = {\n        id: this.messages.length + 1,\n        content: this.inputMessage,\n        isSent: true,\n        time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\n      };\n      this.messages.push(newMessage);\n      this.inputMessage = '';\n\n      // 发送消息到后端\n      this.$axios.post(`/messages/send/${this.selectedContactId}`, {\n        content: newMessage.content\n      })\n        .then(response => {\n          // 处理成功响应\n          const replyMessage = response.data;\n          this.messages.push(replyMessage);\n        })\n        .catch(error => {\n          console.error('发送消息失败:', error);\n          this.$message.error('发送消息失败，请稍后重试');\n          // 移除刚才添加的消息\n          this.messages.pop();\n          this.inputMessage = newMessage.content;\n        });\n    }\n  }\n};\n</script>\n\n<style scoped>\n.chat-room-container {\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n}\n\n.chat-container {\n  display: flex;\n  flex: 1;\n  overflow: hidden;\n  border-top: 1px solid #eee;\n}\n\n.message-list {\n  width: 300px;\n  border-right: 1px solid #eee;\n  display: flex;\n  flex-direction: column;\n}\n\n.search-bar {\n  padding: 10px;\n  border-bottom: 1px solid #eee;\n}\n\n.contact-list {\n  flex: 1;\n  overflow-y: auto;\n}\n\n.contact-item {\n  display: flex;\n  padding: 10px;\n  border-bottom: 1px solid #f5f5f5;\n  cursor: pointer;\n  align-items: center;\n}\n\n.contact-item:hover {\n  background-color: #f5f5f5;\n}\n\n.contact-item.active {\n  background-color: #e9f5ff;\n}\n\n.avatar {\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  margin-right: 10px;\n}\n\n.contact-info {\n  flex: 1;\n  overflow: hidden;\n}\n\n.contact-name {\n  font-weight: bold;\n  margin-bottom: 2px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.last-message {\n  font-size: 12px;\n  color: #666;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.message-time {\n  font-size: 12px;\n  color: #999;\n  margin-left: 5px;\n}\n\n.unread-count {\n  background-color: #ff4d4f;\n  color: white;\n  border-radius: 10px;\n  width: 18px;\n  height: 18px;\n  font-size: 12px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-left: 5px;\n}\n\n.chat-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n}\n\n.chat-header {\n  padding: 10px;\n  border-bottom: 1px solid #eee;\n  display: flex;\n  align-items: center;\n}\n\n.messages-container {\n  flex: 1;\n  padding: 20px;\n  overflow-y: auto;\n  background-color: #f9f9f9;\n}\n\n.message-wrapper {\n  margin-bottom: 15px;\n  display: flex;\n  flex-direction: column;\n}\n\n.message-bubble {\n  max-width: 60%;\n  padding: 10px;\n  border-radius: 8px;\n  word-break: break-word;\n}\n\n.sent {\n  background-color: #95ec69;\n  align-self: flex-end;\n}\n\n.received {\n  background-color: white;\n  align-self: flex-start;\n}\n\n.message-time {\n  font-size: 12px;\n  color: #999;\n  margin-top: 5px;\n}\n\n.sent-time {\n  align-self: flex-end;\n}\n\n.received-time {\n  align-self: flex-start;\n}\n\n.message-input {\n  padding: 10px;\n  border-top: 1px solid #eee;\n}\n\n.send-button {\n  text-align: right;\n  margin-top: 10px;\n}\n\n.no-selection {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #999;\n  font-size: 18px;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}